<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{
    font-family: "Hiragino Kaku Gothic ProN", "Yu Gothic", sans-serif;
    padding:20px;
}

/* 入力フォーム */
.form-area{
    margin-bottom:30px;
}

input, textarea{
    width:300px;
    margin-bottom:10px;
}

/* 稟議書 */
.paper{
    width:800px;
    padding:30px;
    border:1px solid #000;
}

.title{
    text-align:center;
    font-size:28px;
    font-weight:bold;
    letter-spacing:10px;
    margin-bottom:20px;
}

.row{
    display:flex;
    border:1px solid #000;
    border-bottom:none;
}

.cell{
    border-right:1px solid #000;
    padding:8px;
    font-size:14px;
}

.cell:last-child{
    border-right:none;
}

.label{
    width:120px;
    background:#eee;
}

.content-box{
    border:1px solid #000;
    height:150px;
    padding:10px;
    white-space:pre-wrap;
}

.stamp-area{
    border:1px solid #000;
    height:80px;
    margin-top:20px;
    display:flex;
}

.stamp-box{
    flex:1;
    border-right:1px solid #000;
}

.stamp-box:last-child{
    border-right:none;
}
</style>
</head>

<body>

<h2>入力フォーム</h2>

<div class="form-area">

部署名<br>
<input id="dept" value="斑鳩"><br>

氏名<br>
<input id="name" value="ムギ"><br>

件名<br>
<input id="titleInput" value="セクハラ防止委員会設立の件"><br>

起案日<br>
<input id="dateInput" type="date"><br>

内容<br>
<textarea id="contentInput" rows="5">セクハラ防止委員会を設立したい。</textarea><br>

<button onclick="updatePreview()">反映</button>
<button onclick="downloadPDF()">PDFダウンロード</button>

</div>


<!-- ===== 稟議書 ===== -->

<div id="pdfArea" class="paper">

<div class="title">稟 議 書</div>

<div class="row">
    <div class="cell label">起案者</div>
    <div class="cell" style="flex:1">
        （部署名）<span id="dept"></span>
        &nbsp;&nbsp;&nbsp;&nbsp;
        （氏名）<span id="name"></span>
    </div>
</div>

<div class="row">
    <div class="cell label">件名</div>
    <div class="cell" style="flex:1">
        <span id="title"></span>
    </div>
    <div class="cell label">起案日</div>
    <div class="cell" style="width:160px">
        <span id="date"></span>
    </div>
</div>

<div style="margin-top:15px;">

<div style="border:1px solid #000;">
    <div style="background:#eee;padding:5px;">内容</div>
    <div id="content" class="content-box"></div>
</div>

</div>

<div class="stamp-area">
    <div class="stamp-box"></div>
    <div class="stamp-box"></div>
    <div class="stamp-box"></div>
    <div class="stamp-box"></div>
</div>

</div>


<script>
function updatePreview(){

    document.getElementById("dept").innerText =
        document.getElementById("dept").value;

    document.getElementById("name").innerText =
        document.getElementById("name").value;

    document.getElementById("title").innerText =
        document.getElementById("titleInput").value;

    document.getElementById("date").innerText =
        document.getElementById("dateInput").value;

    document.getElementById("content").innerText =
        document.getElementById("contentInput").value;
}


function downloadPDF(){

    const element = document.getElementById("pdfArea");

    const opt = {
        margin: 10,
        filename: "稟議書.pdf",
        image: { type: 'jpeg', quality: 1 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
    };

    html2pdf().set(opt).from(element).save();
}
</script>

</body>
</html>
